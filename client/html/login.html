<div class="d-flex justify-content-center h-100">

<h1>Smartphone as a security token</h1>

<div id="login_card" class="card">
	<div class="card-header">
		<h3>Log In</h3>
	</div>
	<div class="card-body">
		<form id="login_form">
			<div class="input-group form-group">
				<div class="input-group-prepend">
					<span class="input-group-text">
						<i class="fas fa-user"></i></span>
				</div>
				<input id="log_username" type="text" class="form-control"
					placeholder="username" pattern="[a-zA-Z0-9-_]{6,12}"
					title="6 to 12 alphanumeric characters (optional underscore and/or hyphen)" required>
				
			</div>
			<div class="input-group form-group">
				<div class="input-group-prepend">
					<span class="input-group-text">
						<i class="fas fa-key"></i></span>
				</div>
				<input id="log_password" type="password" class="form-control"
					placeholder="password" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#\$%\^&]).{10,}"
					title="Mimimum 10 characters. Must include uppercase, lowercase, digit and a special character." required>
			</div>
			<!--
			<div class="row align-items-center remember">
				<input type="checkbox">Remember Me
			</div>
			-->
			<div class="form-group">
				<input type="submit" value="Log In" id="login_btn"
					class="btn float-right login_btn">
			</div>
		</form>
	</div>
	<div class="card-footer">
		<div class="d-flex justify-content-center links">
			Don't have an account?<a id="goto_register" href="#">Register</a>
		</div>
		<!--
		<div class="d-flex justify-content-center">
			<a href="#">Forgot your password?</a>
		</div>
		-->
	</div>
</div>

<div id="login_alerts"></div>

</div>

<div class="modal" id="duoModal">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title">Duo 2FA</h4>
				<button type="button" class="close" data-dismiss="modal">&times;</button>
			</div>
			<div class="modal-body" id="duoModalBody">
				<!-- TO BE FILLED-->
				<iframe id="duo_iframe"></iframe>
			</div>
		</div>
	</div>
</div>


<script>
$("#goto_register").click( function(e) {
	showRegisterPage();
	e.preventDefault();
});
$("#login_form").submit( function(e) {

	if (!window.smartphonePassword) {
		alert("Please set the smartphone's password in the settings.");
	} else {
		login();
	}
	
	e.preventDefault();
});
</script>
